<!DOCTYPE html>
<html>
<head>
	<title>ThreeJsApi</title>
	<script type="text/javascript" src="jQuery/jquery-1.10.2.min.js"></script>
	<script type="text/javascript" src="ThreeJs/build/three.min.js"></script>

	<script type="text/javascript" src="ThreeJs/examples/js/libs/stats.min.js"></script>

	<script type="text/javascript" src="Api/TJSApi.js"></script>
	<script type="text/javascript" src="Api/FactoryTJS.js"></script>
	<script type="text/javascript" src="Api/FactoryAPI.js"></script>
	<script type="text/javascript" src="Api/FactoryAPI/Camera.js"></script>
	<script type="text/javascript" src="Api/FactoryAPI/Fog.js"></script>
	<script type="text/javascript" src="Api/FactoryAPI/Geometry.js"></script>
	<script type="text/javascript" src="Api/FactoryAPI/Material.js"></script>
	<script type="text/javascript" src="Api/FactoryAPI/Mouse.js"></script>
	<script type="text/javascript" src="Api/FactoryAPI/Object.js"></script>
	<script type="text/javascript" src="Api/FactoryAPI/Renderer.js"></script>
	<script type="text/javascript" src="Api/FactoryAPI/Scene.js"></script>
	<script type="text/javascript" src="Api/FactoryAPI/Texture.js"></script>

</head>
<body>

<div id="D1" style="border: 1px dotted red"></div>

<script type="text/javascript">

// Instance
var Engine = TJSApi.Engine();


var Renderer = Engine.Factory().Renderer().WebGL();
var Camera = Engine.Factory().Camera().Perspective();
var Scene = Engine.Factory().Scene();

// Init
Engine.Renderer( Renderer ).Camera( Camera ).Scene( Scene );

Engine.Helper().Axis( 300 );

// Setup
Engine.Renderer().Display( 'div#D1' ).Width( 800 ).Height( 600 );

Engine.Camera()
	.FieldOfView( 40 )
	.AspectRatio( Engine.Renderer().Width() / Engine.Renderer().Height() )
	.NearClippingDistance( 0.1 )
	.FarClippingDistance( 10000 );

Engine.Scene().Add( Camera );

// Objects

var GeometryTorus = Engine.Factory().Geometry().Torus( 400, 20 );
var GeometryCube = Engine.Factory().Geometry().Cube( 300, 300, 300 );
var GeometryPlane = Engine.Factory().Geometry().Plane( 1000, 1000 );
var GeometryBird = Engine.Factory().Geometry().Bird();

var MaterialTorus = Engine.Factory().Material().Mesh().Basic();
var MaterialCube = Engine.Factory().Material().Mesh().Basic();
var MaterialPlane = Engine.Factory().Material().Mesh().Basic();
var MaterialBird = Engine.Factory().Material().Mesh().Basic();

var MeshTorus = Engine.Factory().Object().Mesh( GeometryTorus, MaterialTorus );
MeshTorus.MouseClickable( true );
var MeshCube = Engine.Factory().Object().Mesh( GeometryCube, MaterialCube );
MeshCube.MouseClickable( true );
var MeshPlane = Engine.Factory().Object().Mesh( GeometryPlane, MaterialPlane );
MeshPlane.MouseClickable( true );
var MeshBird = Engine.Factory().Object().Mesh( GeometryBird, MaterialBird );
//MeshBird.MouseClickable( true );

// Setup - Object
MeshPlane.RotationX( - 90 * Math.PI / 180 );

MaterialTorus.Color('#FF0000');
MaterialTorus.WireFrame(true);

MaterialCube.Color('#00FF00');
MaterialCube.WireFrame(true);

MaterialPlane.Color('#0000FF');
MaterialPlane.WireFrame(true);

// Scene
Engine.Scene().Add( MeshTorus );
Engine.Scene().Add( MeshCube );
Engine.Scene().Add( MeshPlane );
Engine.Scene().Add( MeshBird );

// Setup - Camera

Engine.Camera().PositionZ(1000).PositionY(1000).PositionX(1000).LookAt( Engine.Scene() );


var Mouse = Engine.Factory().Mouse( Engine.Renderer(), Engine.Camera(), Engine.Scene() );


var MousePressPosition = { X: 0, Y: 0, Z: 0 };

Mouse.Event().Click().Left(function(){
	Camera.LookAt( Mouse.Event().Object() );
});

Mouse.Event().Press().Right(function(){
	MousePressPosition = Mouse.MousePosition2D();
});

Mouse.Event().Move().Right(function(){
	var MouseMovePosition = Mouse.MousePosition2D();
	if( MouseMovePosition.X < MousePressPosition.X ) {
		Camera.Controller( 0, 0.03, 0 );
	} else if( MouseMovePosition.X > MousePressPosition.X ) {
		Camera.Controller( 0, -0.03, 0 );
	}
	if( MouseMovePosition.Y < MousePressPosition.Y ) {
		Camera.Controller( -0.02, 0, 0 );
	} else if( MouseMovePosition.Y > MousePressPosition.Y ) {
		Camera.Controller( 0.02, 0, 0 );
	}
	MousePressPosition = Mouse.MousePosition2D();
});

Mouse.Event().Wheel().Up(function(){
	Camera.Controller( 0, 0, -100 );
});

Mouse.Event().Wheel().Down(function(){
	Camera.Controller( 0, 0, 100 );
});

// Render
Engine.Animation.Loop = function() {
//	MeshTorus.RotationX( MeshTorus.RotationX() + 0.01 );
//	MeshCube.RotationY( MeshCube.RotationY() + 0.01 );
	Camera.Controller( 0, 0.02, 0 );
};

TJSApi.Debug.PerformanceMonitor.Enable( Engine );
//TJSApi.Debug.MessageMonitor.Enable( Engine );

//Camera.LookAt( MeshCube );

Engine.Animation.Run();

/* */
</script>
</body>
</html>
